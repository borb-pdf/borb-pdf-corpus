                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Recovering High Dynamic Range Radiance Maps from Photographs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Paul E. Debevec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Jitendra Malik
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             University of California at Berkeley1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ABSTRACT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                true measurements of relative radiance in the scene. For example, if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   We present a method of recovering high dynamic range radiance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           onepixelhastwicethevalueofanother,itisunlikelythatitobserved
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   maps from photographs taken with conventional imaging equip-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            twice the radiance. Instead, there is usually an unknown, nonlinear
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ment. In our method, multiple photographs of the scene are taken                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        mapping that determines how radiance in the scene becomes pixel
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   with different amounts of exposure. Our algorithm uses these dif-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       values in the image.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ferentlyexposedphotographstorecovertheresponsefunctionofthe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                This nonlinear mapping is hard to know beforehand because it is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   imagingprocess, up to factor of scale, using the assumption of reci-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    actually the composition of several nonlinear mappings that occur
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   procity. With the known response function, the algorithm can fuse                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       in the photographic process. In a conventional camera (see Fig. 1),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the multiple photographs into a single, high dynamic range radiance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     the ﬁlm is ﬁrst exposed to light to form a latent image. The ﬁlm is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   mapwhosepixelvaluesareproportional tothetrueradiance values                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             then developed to change this latent image into variations in trans-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   in the scene. We demonstrate our method on images acquired with                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         parency, or density, onthe ﬁlm. The ﬁlmcanthenbedigitizedusing
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   both photochemical and digital imaging processes. We discuss how                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       a ﬁlm scanner, which projects light through the ﬁlm onto an elec-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   this work is applicable in many areas of computer graphics involv-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     tronic light-sensitive array, converting the image to electrical volt-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ing digitized photographs, including image-based modeling, image                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ages. These voltages are digitized, and then manipulated before ﬁ-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   compositing, and image processing. Lastly, we demonstrate a few                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        nally being written to the storage medium. If prints of the ﬁlm are
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   applications of having high dynamic range radiance maps, such as                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       scanned rather than the ﬁlmitself, then the printing process can also
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   synthesizing realistic motion blur and simulating the response ofthe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   introduce nonlinear mappings.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   humanvisual system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       In the ﬁrst stage of the process, the ﬁlm response to variations
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          in exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                               (which is E                                                                                                                                                                                                                                                                                                                                                                                                                            t                           , the product of the irradiance E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      CR Descriptors: I.2.10 [Artiﬁcial Intelligence]: Vision and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ﬁlm receives and the exposure time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               t                           ) is a non-linear function,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Scene Understanding - Intensity, color, photometry and threshold-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       called the “characteristic curve” of the ﬁlm. Noteworthy in the typ-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ing; I.3.7[ComputerGraphics]: Three-DimensionalGraphicsand                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ical characteristic curve is the presence of a small response with no
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Realism - Color, shading, shadowing, and texture ; I.4.1 [Image                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         exposure and saturation at high exposures. The development, scan-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Processing]: Digitization - Scanning; I.4.8 [Image Processing]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ning and digitization processes usually introduce their own nonlin-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Scene Analysis - Photometry, Sensor Fusion.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             earities which compose to give the aggregate nonlinear relationship
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           between the image pixel exposures X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             and their values Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1 Introduction                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Digital cameras, which use charge coupled device (CCD) arrays
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           to image the scene, are prone to the same difﬁculties. Although the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Digitizedphotographs arebecomingincreasinglyimportantincom-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             charge collected by a CCD element is proportional to its irradiance,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   puter graphics. More than ever, scanned images are used as texture                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      mostdigital cameras apply a nonlinear mapping tothe CCDoutputs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   maps for geometric models, and recent work in image-based mod-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          before they are written to the storage medium. This nonlinear map-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   eling and rendering uses images as the fundamental modeling prim-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       pingisusedinvariouswaystomimictheresponsecharacteristicsof
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   itive. Furthermore, many of today’s graphics applications require                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ﬁlm,anticipate nonlinear responses in the display device, and often
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   computer-generated images to mesh seamlessly with real photo-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           to convert 12-bit output from the CCD’s analog-to-digital convert-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   graphicimagery. Properlyusingphotographicallyacquiredimagery                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ers to 8-bit values commonly used to store images. As with ﬁlm,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   in these applications can greatly beneﬁt from an accurate model of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      the most signiﬁcant nonlinearity in the response curve is at its sat-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the photographic process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               uration point, where any pixel with a radiance above a certain level
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      When we photograph a scene, either with ﬁlm or an elec-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              is mapped to the same maximum image value.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tronic imaging array, and digitize the photograph to obtain a two-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Why is this any problem at all? The most obvious difﬁculty,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   dimensional array of “brightness” values, these values are rarely                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       as any amateur or professional photographer knows, is that of lim-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ited dynamic range—one hastochoose therangeofradiancevalues
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1Computer Science Division, University of California at Berkeley,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             that are of interest and determine the exposure time suitably. Sunlit
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Berkeley,                                                                                                                                                                                                                                                                                         CA 94720-1776.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Email:                                                                                                                                                                                                                                                        debevec@cs.berkeley.edu,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ma-                                                                                                                                                                                                                                                                                                                                                                                         scenes, and scenes with shiny materials and artiﬁcial light sources,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   lik@cs.berkeley.edu. More information and additional results may be found                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               often have extreme differences in radiance values that are impossi-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   at: http://www.cs.berkeley.edu/˜debevec/Research                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ble to capture without either under-exposing or saturating the ﬁlm.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Tocoverthefulldynamicrangeinsuchascene,onecantakeaseries
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of photographs with different exposures. This then poses a prob-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           lem: how can we combine these separate images into a composite
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           radiance map? Here the fact that the mapping from scene radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           to pixel values is unknown and nonlinear begins to haunt us. The
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           purpose of this paper is to present a simple technique for recover-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ing this response function, up to a scale factor, using nothing more
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           than a set of photographs taken with varying, known exposure du-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           rations. With this mapping, we then use the pixel values from all
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           available photographs to construct an accurate map of the radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           in the scene, up to a factor of scale. This radiance map will cover
                               Lens                  Shutter                  Film          Development               CCD                 ADC             Remapping
                     scene                sensor                 sensor                                                                                                  final
                    radiance             irradiance             exposure                latent              film                 analog             digital             digital
                       (L)                  (E)                    (X)                  image             density               voltages            values             values
                                                                              Film Camera                                                                                (Z)
                                                                              Digital Camera
                  Figure 1: Image Acquisition Pipeline shows how scene radiance becomes pixel values for both ﬁlm and digital cameras. Unknown nonlin-
                  ear mappings can occur during exposure, development, scanning, digitization, and remapping. The algorithm in this paper determines the
                  aggregate mapping from scene radiance L          to pixel values Z   from a set of differently exposed images.
                  the entire dynamic range captured by the original photographs.                     Imagecompositing
                  1.1    Applications                                                                Many applications in computer graphics involve compositing im-
                                                                                                     age data from images obtained by different processes. For exam-
                  Ourtechnique of deriving imaging response functions and recover-                   ple, a background matte might be shot with a still camera, live
                  ing high dynamic range radiance maps has many possible applica-                    action might be shot with a different ﬁlm stock or scanning pro-
                  tions in computer graphics:                                                        cess, and CG elements would be produced by rendering algorithms.
                                                                                                     When there are signiﬁcant differences in the response curves of
                                                                                                     these imaging processes, the composite image can be visually un-
                  Image-basedmodelingandrendering                                                    convincing. Thetechniquepresentedinthispaperprovidesaconve-
                  Image-based modeling and rendering systems to date (e.g. [11, 15,                  nient and robust method of determining the overall response curve
                  2, 3, 12, 6, 17]) make the assumption that all the images are taken                ofanyimagingprocess,allowingimagesfromdifferentprocessesto
                  with the same exposure settings and ﬁlm response functions. How-                   be used consistently as radiance maps. Furthermore, the recovered
                  ever, almost any large-scale environment will have some areas that                 response curves can be inverted to render the composite radiance
                  are much brighter than others, making it impossible to adequately                  mapasifithadbeenphotographed withanyoftheoriginalimaging
                  photograph the scene using a single exposure setting. In indoor                    processes, or a different imaging process entirely.
                  scenes with windows, this situation often arises within the ﬁeld of                Aresearchtool
                  viewofasinglephotograph, sincetheareasvisiblethroughthewin-                        One goal of computer graphics is to simulate the image formation
                  dowscan be far brighter than the areas inside the building.                        process in a way that produces results that are consistent with what
                     Bydeterminingtheresponsefunctionsoftheimagingdevice,the                         happens in the real world. Recovering radiance maps of real-world
                  method presented here allows one to correctly fuse pixel data from                 scenes should allow more quantitative evaluations of rendering al-
                  photographs taken at different exposure settings. As a result, one                 gorithms to be made in addition to the qualitative scrutiny they tra-
                  canproperlyphotographoutdoorareaswithshortexposures, andin-                        ditionally receive. In particular, the method should be useful for de-
                  door areas with longer exposures, without creating inconsistencies                 velopingreﬂectanceandilluminationmodels,andcomparingglobal
                  in the data set. Furthermore, knowing the response functions can                   illumination solutions against ground truth data.
                  behelpfulinmergingphotographstakenwithdifferentimagingsys-                            Rendering high dynamic range scenes on conventional display
                  tems,suchasvideocameras, digitalcameras, andﬁlmcameraswith                         devices is the subject of considerable previous work, including [20,
                  various ﬁlm stocks and digitization processes.                                     16, 5, 23]. The work presented in this paper will allow such meth-
                     The area of image-based modeling and rendering is working to-                   ods to be tested on real radiance maps in addition to synthetically
                  ward recovering more advanced reﬂection models (up to complete                     computed radiance solutions.
                  BRDF’s) of the surfaces in the scene (e.g. [21]). These meth-
                  ods, which involve observing surface radiance in various directions                1.2    Background
                  under various lighting conditions, require absolute radiance values
                  rather than the nonlinearly mapped pixel values found in conven-                   Thephotochemical processes involved in silver halide photography
                  tionalimages. Justasimportant,therecoveryofhighdynamicrange                        have been the subject of continued innovation and research ever
                  images will allow these methods to obtain accurate radiance val-                   since the invention of the daguerretype in 1839. [18] and [8] pro-
                  uesfromsurfacespecularitiesandfromincidentlightsources. Such                       vide a comprehensive treatment of the theory and mechanisms in-
                  higherradiancevaluesusuallybecomeclampedinconventional im-                         volved. Forthenewertechnologyofsolid-stateimagingwithcharge
                  ages.                                                                              coupled devices, [19] is an excellent reference. The technical and
                                                                                                     artisticproblemofrepresentingthedynamicrangeofanaturalscene
                  Imageprocessing                                                                    on the limited range of ﬁlm has concerned photographers from the
                                                                                                     early days – [1] presents one of the best known systems to choose
                  Mostimageprocessingoperations, suchasblurring, edgedetection,                      shutter speeds, lens apertures, and developing conditions to best co-
                  color correction, and image correspondence, expect pixel values to                 erce the dynamic range of a scene to ﬁt into what is possible on a
                  be proportional to the scene radiance. Because of nonlinear image                  print. In scientiﬁc applications of photography, such as in astron-
                  response, especially at the point of saturation, these operations can              omy,thenonlinearﬁlmresponsehasbeenaddressedbysuitablecal-
                  produce incorrect results for conventional images.                                 ibration procedures. It is our objective instead to develop a simple
                     In computer graphics, one common image processing operation                     self-calibrating procedure not requiring calibration charts or photo-
                  is the application of synthetic motion blur to images. In our re-                  metric measuring devices.
                  sults (Section 3), we will show that using true radiance maps pro-                    In previous work, [13] used multiple ﬂux integration times of a
                  duces signiﬁcantly more realistic motion blur effects for high dy-                 CCDarraytoacquireextendeddynamicrangeimages. Sincedirect
                  namic range scenes.                                                                CCDoutputswereavailable, the work did not need to deal with the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   problemofnonlinearpixelvalueresponse. [14]addressedtheprob-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             quantities we will be dealing with are weighted by the spectral re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   lemofnonlinear response but provide arather limitedmethod ofre-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sponse at the sensor site. For color photography, the color channels
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   covering the response curve. Speciﬁcally, a parametric form of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      maybetreated separately.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   response curve is arbitrarily assumed, there is no satisfactory treat-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Theinput to our algorithm is a number of digitized photographs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ment of image noise, and the recovery process makes only partial                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        taken from the same vantage point with different known exposure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   use of the available data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              durations                                                                                                                                                                                                                                                                                                                                                             t                                                           .4 Wewillassumethatthesceneisstaticandthatthis
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           process is completed quickly enough that lighting changes can be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   2 TheAlgorithm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          safelyignored. Itcanthenbeassumedthattheﬁlmirradiancevalues
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Thissectionpresents our algorithm for recovering the ﬁlmresponse                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        E                                                        i                                         for each pixel i are constant. We will denote pixel values by Z ij
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   function, and then presents our method of reconstructing the high                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       where i is a spatial index over pixels and j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  indexes over exposure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   dynamic range radiance image from the multiple photographs. We                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          times                                                                                                                                                                                                                                                 t                           j                               . We may now write down the ﬁlm reciprocity equation
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   describe the algorithm assuming a grayscale imaging device. We                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          as:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   discuss how to deal with color in Section 2.6.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Z                                                   ij                                                                          =                                                                                f                                            (                             E                                                        i                                                                                        t                           j                                )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Sinceweassume f ismonotonic, itisinvertible, and wecanrewrite
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   2.1                                                                                                                                                                                                  Film Response Recovery                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (1) as:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     f                                                                                            1                                  (                             Z                                                                                                          )=                                                                                                                                  E                                                                                                                                                 t
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Ouralgorithmisbasedonexploitingaphysicalpropertyofimaging                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ij                                                                                                                                                                                                                                                  i                                                                                                                     j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   systems, both photochemical and electronic, known as reciprocity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Taking the natural logarithm of both sides, we have:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Let us consider photographic ﬁlm ﬁrst. The response of a ﬁlm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ln                                                                          f                                                                                            1                                  (                             Z                                                                                                          )=ln                                                                                                                                                                                                             E                                                                                                   +ln                                                                                                                                                                                                                      t
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   to variations in exposure is summarized by the characteristic curve                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ij                                                                                                                                                                                                                                                                                                                               i                                                                                                                                                                                                                                                                                                j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (or Hurter-Drifﬁeld curve). This is a graph of the optical density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      To simplify notation, let us deﬁne function g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       =                                                                                              ln                                                                           f                                                                                            1                                  .Wethen
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   D                                                                                          of the processed ﬁlm against the logarithm of the exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 have the set of equations:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   to which it has been subjected. The exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    is deﬁned as the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   product of the irradiance E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                at the ﬁlm and exposure time,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              t                           ,so                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            g                                       (                             Z                                                   ij                                                    )=ln                                                                                                                                                                                                              E i +ln                                                                                                                                                                                                                                                                                                                     t j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   that its units are Jm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2                                 . Key to the very concept of the characteris-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tic curve is the assumption that only the product E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     t                                             is important,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    where i ranges over pixels and j ranges over exposure durations. In
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   that halving E                                                                                                                                                                                                                                                                                                                                                                                                                                         anddoubling                                                                                                                                                                                                                                                                                                                                                                                                                                                                        t                                        willnotchangetheresultingoptical                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    this set of equations, the Z ij                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     are known, as are the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                t                           j                               .                                                          The un-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   density D                                                                                                                                                                                                                                                                                                  . Under extreme conditions (very large or very low                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        t                                              ),                                                                                                                                                                                                                                                 knowns are the irradiances E i , as well as the function g , although
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the reciprocity assumption can break down, a situation described as                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     weassume that g is smooth and monotonic.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   reciprocity failure. In typical print ﬁlms, reciprocity holds to within                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Wewishtorecoverthefunction g andtheirradiances E i thatbest
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1                                                           stop1 for exposure times of 10 seconds to 1/10,000 of a second. 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  satisfythesetofequationsarisingfromEquation2inaleast-squared
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              error sense. We note that recovering g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  only requires recovering the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   In the case of charge coupled arrays, reciprocity holds under the as-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ﬁnite number of values that g ( z ) can take since the domain of Z ,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sumption that each site measures the total number of photons it ab-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     pixel brightness values, is ﬁnite. Letting Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       and Z                                                                                                                                                                                                                                                                                                                                             be the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sorbs during the integration time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        min                                                                                                                                                                                                                                                                                                                                       max
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      After the development, scanning and digitization processes, we                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       least and greatest pixel values (integers), N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              be the number of pixel
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   obtain a digital number Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , which is a nonlinear function of the orig-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      locations and P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  be the number of photographs, we formulate the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   inal exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                at the pixel. Let us call this function f , which is the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 problem as one of ﬁnding the ( Z max                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Z                                                   min                                                                                                                                      +1)                                                                                                                                                                 values of g ( Z                                                                                                                                                                                                                                                                                                                                                                                                                  )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   composition of the characteristic curve of the ﬁlm as well as all the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   andtheN                                                                                                                                                                                                                                                                                                                  values of ln                                                                                                                                                                                                                                                                                                                                                            E                                                        i                                        that minimizethe followingquadratic ob-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   nonlinearities introducedbythelaterprocessingsteps. Ourﬁrstgoal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         jective function:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   will be to recover this function f . Once we have that, we can com-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  pute the exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           at each pixel, as X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 =                                                                                    f                                                                                            1                                  (                             Z                                                        )                             .Wemakethe
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          N                                                                                                                                       P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Z                                         max                                                                                                                                                                     1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   reasonable assumption that the function f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          is monotonically increas-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    O                                                                                    =                                                                                X                                                                                                                                    X                                                                                                                                   [                     g                                       (                             Z                                                   ij                                                    )                                                                                                                           ln                                                                          E                                                        i                                                                                                                       ln                                                                                                                                          t                           j                               ]                    2                                                   +                                                                                                                                                                                                                                    X                                                                                                                                                                                                                                   g                                       00                                      (                             z                                      )                             2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ing, so its inverse f   1 is well deﬁned. Knowing theexposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  the exposure time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t                           , the irradiance E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     is recovered as E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          =                                                                                X                                                             =                                                                                                    t                           ,                                                                                                                                                                                                                                                                                                                                                                                                                                  i                     =1                                                                                                          j                           =1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       z                               =                                              Z                                         min                                                                                                             +1                                                                                                                                                                                                                                               (3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   whichwewilltaketobeproportionaltotheradiance L inthescene.3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                The ﬁrst term ensures that the solution satisﬁes the set of equa-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Before proceeding further, we should discuss the consequences                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        tions arising from Equation 2 in a least squares sense. The second
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  of the spectral response of the sensor. The exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      should be                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    term is a smoothness term on the sum of squared values of the sec-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   thoughtofasafunctionofwavelength X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (                                                                         )                             , andtheabscissaonthe
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ond derivative of g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     to ensure that the function g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               is smooth; in this
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   characteristic curve should be the integral                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                X                                                                    (                                                                         )                             R                                                          (                                                                         )                             d                                                                                                           where                                                                                                                                                                                                                                                                                                                                                                                         discrete setting we use g 00 ( z )=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  g (z                                                                                                                                                                                           1)                                                                                                                                                    2                                     g                                       (                             z                                      )+                                                                                                              g                                       ( z                                                                             +1)                                                                                                                                        .This
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   R                                                         (                                                                         )                                              is the spectral response of the sensing element at the pixel lo-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    smoothness term is essential to the formulation in that it provides
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cation. Strictly speaking, our use of irradiance, a radiometric quan-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   coupling between the values g ( z ) in the minimization. The scalar
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tity, is not justiﬁed. However, thespectral response of thesensor site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                weights the smoothness term relative to the data ﬁtting term, and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   may not be the photopic luminosity function V  , so the photomet-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      should be chosen appropriately for the amount of noise expected in
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ric term illuminance is not justiﬁed either. In what follows, we will                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the Z                                                                                                                                                             ij                                                                       measurements.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   usethetermirradiance, whileurgingthereadertorememberthatthe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Because it is quadratic in the E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              i                        ’s and g ( z ) ’s, minimizing O                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           astraightforward linear least squares problem. The overdetermined
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1                                                                                                                                                                                                                                                                                                                                                                                                                                 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1stop is a photographic term for a factor of two;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              stop is thus 2 3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    4Most modern SLR cameras have electronically controlled shutters
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Aneven larger dynamic range can be covered by using neutral density                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              which give extremely accurate and reproducible exposure times. We tested
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ﬁlters to lessen to amount oflight reaching the ﬁlmforagivenexposure time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              our Canon EOS Elan camera by using a Macintosh to make digital audio
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Adiscussion ofthe modes ofreciprocity failure may be found in [18], ch. 4.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             3L                                                                                                is proportional                                                                                                                                                                                                                                                                                                                                                                                                                  E                                                                             for any particular pixel, but it is possible for the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         recordings of the shutter. By analyzing these recordings we were able to
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   proportionality factor to be different at different places on the sensor. One                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           verify the accuracy of the exposure times to within a thousandth of a sec-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            d                                                                                2                                                                                                                                                4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ond. Conveniently, we determined that the actual exposure times varied by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   formula for this variance, given in [7], is E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       =                                                                              L                                                             4                                                                                                       f                                                                                                                                 cos                                                                                                                                                                             ,where                                                                                                                                                                                                                                                                                                                                                                                                                                                                     powersoftwobetweenstops( 1 , 1 , 1 , 1 , 1 , 1 ,1,2,4,8,16,32),rather
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   measures the pixel’s angle from the lens’ optical axis. However, most mod-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  64                                                                                                              32                                                                                                             16                                                                                                              8                                                                                4                                                                                2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           than the rounded numbers displayed on the camera readout ( 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                        1                                                       ,                                                        1                                                       , 1                                                                               ,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ern camera lenses are designed to compensate for this effect, and provide a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 60                                                                                                               30                                                                                                               15                                                                                                               8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   nearly constant mapping between radiance and irradiance at f/8 and smaller                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1                                       , 1                                                                                     , 1, 2, 4, 8, 15, 30). Because of problems associated with vignetting,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     4                                                                                      2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   apertures. See also [10].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               varying the aperture is not recommended.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   systemoflinearequationsisrobustlysolvedusingthesingularvalue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2.2                                                                                                                                                                                                   Constructing the High Dynamic Range Radi-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   decomposition (SVD) method. An intuitive explanation of the pro-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              anceMap
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cedure may be found in Fig. 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Once the response curve g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         is recovered, it can be used to quickly
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Weneedtomakethreeadditionalpointstocompleteourdescrip-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               convert pixel values to relative radiance values, assuming the expo-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tion of the algorithm:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sure                                                                                                                                                                                                       t                                                                           is known. Notethat the curve can be used to determine ra-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      First, the solution for the g ( z )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        and E                                                                                                                                                                                                                                       values can only be up to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             diancevaluesinanyimage(s)acquiredbytheimagingprocessasso-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   a single scale factor  . If each log irradiance value ln                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      E                                                        i                                              were re-                                                                                                                                                                                                                                                                                                                                                                                                                                                         ciated with g , not just the images used to recover the response func-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  placed by ln                                                                                                                                                                                                                                                                                                                                                                                  E                                                        i                                      +                                                                                                                         , and the function g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                replaced by g +                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          , the sys-                                                                                                                                                                                                                                                                                                                                                                                                                                                                        tion.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   temof equations 2 and also the objective function O                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 would remain                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           FromEquation 2, we obtain:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   unchanged. To establish a scale factor, we introduce the additional
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   constraint g ( Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                )=0                                                                                                                                                                         ,whereZ                                                                                                                                                                                                                                                                                                                                                                                                                              =                                                                                          1                                        (                             Z                                                                                                                                                                                     +                                                                      Z                                                                                                                                                                                  )                             ,simply
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    mid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      mid                                                                                                                                                                                                                               2                                                                                                                          min                                                                                                                                                                                                                                                          max                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ln                                                                           E                                                                                                       =                                                                                g                                       (                             Z                                                                                                          )                                                                                                                          ln                                                                                                                                          t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (5)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   by adding this as an equation in the linear system. The meaning of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      i                                                                                                                                                                                                                                                         ij                                                                                                                                                                                                                                                                                                                                                         j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   this constraint is that a pixel with value midway between Z min                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     and                                                                                                                                                                                                                                                                                                                                                                                                    For robustness, and to recover high dynamic range radiance val-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Z                                                  max                                                                                                                                                will be assumed to have unit exposure.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ues, we should use all the available exposures for a particular pixel
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Second, the solution can be made to have a much better ﬁt by an-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     tocomputeitsradiance. Forthis,wereusetheweightingfunctionin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ticipating the basic shape of the response function. Since g ( z ) will                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Equation 4 to give higher weight to exposures in which the pixel’s
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   typically have a steep slope near Z min                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        and Z max                                                                                                                                                                                                                                                                                                              , we should ex-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   value is closer to the middle of the response function:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  pect that g ( z )                                                                                                                                                                                                                                                                                                                                                                                                                                 will be less smooth and will ﬁt the data more poorly
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  near these extremes. To recognize this, we can introduce a weight-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 P                                                                                      P                                                                                                                          w                                                        (                             Z                                                   ij                                                     )(                                                          g                                       (                             Z                                                   ij                                                   )                                                                                                                           ln                                                                                                                                          t                           j                               )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ln                                                                          E                                                                                                        =                                                                                                                                                                                 j                           =1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (6)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ingfunctionw ( z ) to emphasize the smoothness and ﬁttingtermsto-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       i                                                                                                                                                                                                                                                                                                                                                                                                                                  P                                                                                       P                                                                                                                         w                                                        (                             Z                                                   ij                                                     )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   wardthemiddleofthecurve. Asensiblechoiceof w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               is a simple hat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        j                           =1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   function:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Combining the multiple exposures has the effect of reducing
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           noise in the recovered radiance values. It also reduces the effects
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of imaging artifacts such as ﬁlm grain. Since the weighting func-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              z                                                                                                                                    Z min                                                                                                                                                                                                                                                                 for z                                                                                                                                                                                                                                                           1                                         (                             Z                                                   min                                                                                                                                     +                                                                            Z                                                   max                                                                                                                            )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           tion ignores saturated pixel values, “blooming” artifacts5 have little
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     w                                                        (                             z                                      )=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z                                                                                                                                                                                                                                                                                 z                                                                                                                        for z>                                                                                                                                                                                                                                                           1 (Z                                                                                                                                                                                                                                                                +                                                                            Z                                                                                                                                                                                  )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           impact on the reconstructed radiance values.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   max                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2                                                                                                                           min                                                                                                                                                                                                                                                                      max
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Equation 3 now becomes:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2.2.1                                                                                                                                                                                                                                             Storage
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           In our implementation the recovered radiance map is computed as
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           anarrayofsingle-precision ﬂoatingpointvalues. Forefﬁciency, the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 N                                                                                                                                       P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 mapcanbeconverted totheimage format used in the RADIANCE
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           O                                                                                    =                                                                               X                                                                                                                                    X                                                                                                                                   f                                      w                                                        (                              Z                                                  ij                                                      )[ g ( Z                                                                                                                                                                                  ij                                                   )                                                                                                                           ln                                                                           E                                                        i                                                                                                                       ln                                                                                                                                          t                           j                               ]                    g                                      2                                                  +                                                                                                                                                                                                                                                                                                                                                                      [22] simulation and rendering system, which uses just eight bits for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           each of the mantissa and exponent. This format is particularly com-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          i                     =1                                                                                                          j                           =1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 pact for color radiance maps, since it stores just one exponent value
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Z                                         max                                                                                                                                                                     1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   X                                                                                                                                                                                                                      [                    w                                                        (                             z                                      )                              g                                      00                                      (                              z                                      )]                                                 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     for all three color values at each pixel. Thus, in this format, a high
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           dynamic range radiance map requires just one third more storage
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    z                               =                                              Z                                         min                                                                                                              +1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           than a conventional RGB image.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Finally, we need not use every available pixel site in this solu-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2.3                                                                                                                                                                                                 Howmanyimagesarenecessary?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  tion procedure. Givenmeasurementsof N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pixels in P                                                                                                                                                                                                                                                                                                                                         photographs,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                To decide on the number of images needed for the technique, it is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   wehave to solve for N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              values of ln                                                                                                                                                                                                                                                                                                                                                                       E                                                        i                                             and ( Z                                                                                                                                                                                                            max                                                                                                                                                                                                                              Z                                                   min                                                                                                                     )                                                 sam-                                                                                                                                                                                                                                                                                                                                                     convenient to consider the two aspects of the process:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ples of g . To ensure a sufﬁciently overdetermined system, we want
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   N                                                                    (                            P                                                                                                                                                  1)                                                                                        >                                                                                (                             Z                                                   max                                                                                                                                                                                                                   Z                                                    min                                                                                                                    )                              . For the pixel value range ( Z max                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1. Recovering the ﬁlm response curve: This requires a minimum
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Z                                                  min                                                                                                                    )                                                                          =                                                                                                       255                                                                                                               , P                                                                                                                                                    =                                                                                                        11                                                                                                   photographs, a choice of N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    on the or-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  of two photographs. Whether two photographs are enough
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   der of 50 pixels is more than adequate. Since the size of the sys-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            can be understood in terms of the heuristic explanation of the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tem of linear equations arising from Equation 3 is on the order of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            process of ﬁlm response curve recovery shown in Fig. 2.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   N                                                                                                                                                                                      P                                                                                       +                                                                                      Z                                                    max                                                                                                                                                                                                                                              Z                                                   min                                                                                                                    , computational complexity considera-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 If the scene has sufﬁciently many different radiance values,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tions make it impractical to use every pixel location in this algo-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           the entire curve can, in principle, be assembled by sliding to-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   rithm. Clearly, thepixellocationsshouldbechosensothattheyhave                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 gether the sampled curve segments, each with only two sam-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   a reasonably even distribution of pixel values from Z min                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     to Z                                                                                                                            max                                                                                                                             ,                                                                                                                                                                                                                                                                                                                                                                                               ples. Note that the photos must be similar enough in their ex-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  andsothat they are spatially well distributed in the image. Further-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           posure amounts that some pixels fall into the working range 6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  more, the pixels are best sampled from regions of the image with                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               of the ﬁlm in both images; otherwise, there is no information
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  low intensity variance so that radiance can be assumed to be con-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              to relate the exposures to each other. Obviously, using more
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  stant across the area of the pixel, and the effect of optical blur of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      than two images with differing exposure times improves per-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  imaging system is minimized. So far we have performed this task                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                formance with respect to noise sensitivity.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  by hand, though it could easily be automated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                2. Recoveringaradiancemapgiventheﬁlmresponsecurve: The
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Note that we have not explicitly enforced the constraint that g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            number of photographs needed here is a function of the dy-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   mustbeamonotonicfunction. Ifdesired, this can be done by trans-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               namic range of radiance values in the scene. Suppose the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   forming the problem to a non-negative least squares problem. We                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               range of maximum to minimum radiance values that we are
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   have not found it necessary because, in our experience, the smooth-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ness penalty term is enough to make the estimated g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               monotonic in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    5Blooming occurs when charge or light at highly saturated sites on the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   addition to being smooth.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               imaging surface spills over and affects values at neighboring sites.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Toshowitssimplicity,the MATLABroutineweusedtominimize                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          6Theworking range of the ﬁlm corresponds to the middle section of the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Equation 5 is included in the Appendix. Running times are on the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        response curve. The ends of the curve, in which large changes in exposure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cause only small changes in density (or pixel value), are called the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        toe and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   order of a few seconds.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 the shoulder.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  plot of g(Zij) from three pixels observed in five images, assuming unit radiance at each pixel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               normalized plot of g(Zij) after determining pixel exposures
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        log exposure (Ei * (delta t)j)−2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           log exposure (Ei * (delta t)j)−2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           −4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         −4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           −6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         −6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0                                                                                                                                                                                                                                                                                                    50                                                                                                                                                                                                                                                                                                    100                                                                                                                                                                                                                                                                                                                150                                                                                                                                                                                                                                                                                                                200                                                                                                                                                                                                                                                                                                                 250                                                                                                                                                                                                                                                                                                                300                                                                                                                                                                                                                                                                                0                                                                                                                                                                                                                                                                                                    50                                                                                                                                                                                                                                                                                                    100                                                                                                                                                                                                                                                                                                                150                                                                                                                                                                                                                                                                                                                200                                                                                                                                                                                                                                                                                                                 250                                                                                                                                                                                                                                                                                                                300
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pixel value (Zij)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          pixel value (Zij)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Figure 2: In the ﬁgure on the left, the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           symbols represent samples of the g                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          curve derived from the digital values at one pixel for 5 different
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   knownexposures usingEquation2. Theunknownlogirradiance ln                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      E                                                        i                                        hasbeenarbitrarilyassumedtobe 0 . Notethattheshape ofthe g curve
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  is correct, though its position on the vertical scale is arbitrary corresponding to the unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ln                                                                           E                                                        i                         .The+                                                                                                                                                                                                                                                                 and                                                                                                                                                                                           symbols show samples of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   g                                                         curve segments derived by consideration of two other pixels; again the vertical position of each segment is arbitrary. Essentially, what we
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   want to achieve in the optimization process is to slide the 3 sampled curve segments up and down (by adjusting their ln                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  E                                                        i                         ’s) until they “line
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   up” into a single smooth, monotonic curve, as shown in the right ﬁgure. The vertical position of the composite curve will remain arbitrary.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        interested in recovering accurately is R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , and the ﬁlm is capa-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           7. In the ﬁrst method, the print negative is scanned with the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           outline
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ble of representing in its working range a dynamic range of F                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            .                                                                                                                                                                                                                         scanner set to scan slide ﬁlm. Most scanners will then record the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Then the minimum number of photographs needed is d R e to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         entire detectable dynamic range of the ﬁlm in the resulting image.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          F
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ensure that every part of the scene is imaged in at least one                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Asbefore, a series of differently exposed images of the same scene
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         photograph at an exposure duration that puts it in the work-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      can be used to recover the response function of the imaging system
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ing range of the ﬁlm response curve. As in recovering the re-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     witheachofthesescannersettings. Thisresponse function canthen
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sponse curve, using more photographs than strictly necessary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      beusedtoconvert individual exposures to radiance maps. Unfortu-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         will result in better noise sensitivity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          nately, since the resulting image is still 8-bits-per-channel, this re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     If one wanted to use as few photographs as possible, one might                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sults in increased quantization.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ﬁrst recover the response curve of the imaging process by pho-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              In the second method, the ﬁlm can be scanned twice with the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  tographing a scene containing a diverse range of radiance values at                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      scanner set to different density adjustment settings. A series of dif-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  three or four different exposures, differing by perhaps one or two                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ferently exposed images of the same scene can then be used to re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  stops. This response curve could be used to determine the working                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cover the response function of the imaging system at each of these
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  range of the imaging process, which for the processes we have seen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       density adjustment settings. These two response functions can then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  wouldbeasmanyasﬁveorsixstops. Fortheremainderoftheshoot,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 beusedtocombinetwoscansofanysinglenegativeusingasimilar
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  the photographer could decide for any particular scene the number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        technique as in Section 2.2.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  of shots necessary to cover its entire dynamic range. For diffuse in-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2.5                                                                                                                                                                                                   Obtaining Absolute Radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  door scenes, only one exposure might be necessary; for scenes with                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       For many applications, such as image processing and image com-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  high dynamic range, several would be necessary. By recording the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         positing, the relative radiance values computed by our method are
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  exposure amount for each shot, the images could then be converted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        all that are necessary. If needed, an approximation to the scaling
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  to radiance maps using the pre-computed response curve.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  termnecessary to convert to absolute radiance can be derived using
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     8 andtheshutterspeedsandexposureamountsin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   2.4                                                                                                                                                                                                  Recoveringextendeddynamicrangefromsin-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             theASAoftheﬁlm
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         gle exposures                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     thephotographs. Withthesenumbers, formulasthatgiveanapprox-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           imate prediction of ﬁlm response can be found in [9]. Such an ap-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Most commericially available ﬁlm scanners can detect reasonably                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         proximation can be adequate for simulating visual artifacts such as
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   close to the full range of useful densities present in ﬁlm. However,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    glare, and predicting areas of scotopic retinal response. If desired,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   manyofthesescanners(aswellastheKodakPhotoCDprocess)pro-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 one could recover the scaling factor precisely by photographing a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   duce8-bit-per-channel images designed to be viewed on a screen or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       calibration luminaire of known radiance, and scaling the radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   printed on paper. Print ﬁlm, however, records a signiﬁcantly greater                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    values to agree with the known radiance of the luminaire.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   dynamicrangethancanbedisplayedwitheitherofthesemedia. As                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                2.6                                                                                                                                                                                                   Color
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   aresult,suchscannersdeliveronlyaportionofthedetecteddynamic
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   range of print ﬁlm in a single scan, discarding information in either                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Color images, consisting of red, green, and blue channels, can be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   high or low density regions. The portion of the detected dynamic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        processed by reconstructing the imaging system response curve for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   range that is delivered can usually be inﬂuenced by “brightness” or
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   “density adjustment” controls.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    7This work was done in collaboration with Gregory Ward Larson
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      The method presented in this paper enables two methods for re-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 8Conveniently, mostdigital camerasalsospecifytheirsensitivity interms
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   covering the full dynamic range of print ﬁlm which we will brieﬂy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       of ASA.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   each channel independently. Unfortunately, there will be three un-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   known scaling factors relating relative radiance to absolute radi-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ance, one for each channel. As a result, different choices of these
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   scaling factors will change the color balance of the radiance map.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      By default, the algorithm chooses the scaling factor such that a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   pixel with value Z mid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     will have unit exposure. Thus, any pixel with
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  the RGB value ( Z mid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ;Z                                                                                    mid                                                                                                               ;Z                                                                                    mid                                                                                                              )                                                    will have equal radiance val-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ues for R, G, and B, meaning that the pixel is achromatic. If the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  three channels of the imaging system actually do respond equally to
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  achromatic light in the neighborhood of Z mid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  , then our procedure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   correctly reconstructs the relative radiances.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      However, ﬁlms are usually calibrated to respond achromatically
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   to a particular color of light C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , such as sunlight or ﬂuorescent light.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  In this case, the radiance values of the three channels should be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  scaled so that the pixel value ( Z mid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ;Z                                                                                    mid                                                                                                               ;Z                                                                                    mid                                                                                                              )                                                  maps to a radi-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ance with the same color ratios as C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            . To properly model the color
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  response of the entire imaging process rather than just the ﬁlm re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sponse, the scaling terms can be adjusted by photographing a cali-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  bration luminaire of known color.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   2.7                                                                                                                                                                                                   Taking virtual photographs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Therecovered response functions can also be used to map radiance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Figure 3: (a) Eleven grayscale photographs of an indoor scene ac-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   values back to pixel values for a given exposure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            t                                                    using Equa-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           quired with a Kodak DCS460 digital camera, with shutter speeds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  tion 1. This process can be thought of as taking a virtual photograph                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    progressing in 1-stop increments from 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         of a second to 30 seconds.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     30
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  of the radiance map, in that the resulting image will exhibit the re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sponse qualities of the modeled imaging system. Note that the re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sponse functions used need not be the same response functions used                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               250
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  to construct the original radiance map, which allows photographs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  acquired with one imaging process to be rendered as if they were                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 200
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  acquired with another.9
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   3 Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       150
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Figures 3-5 show the results of using our algorithm to determine the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              pixel value Z
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   100
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   response curve of a DCS460 digital camera. Eleven grayscale pho-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tographsﬁltereddownto 765                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     509                                                                                                                               resolution(Fig. 3)weretakenat
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   f/8 with exposure times ranging from 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 of a second to 30 seconds,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  30
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  with each image receiving twice the exposure of the previous one.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  The ﬁlm curve recovered by our algorithm from 45 pixel locations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  observedacrosstheimagesequenceisshowninFig. 4. Notethatal-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      −10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     −5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  though CCDimagearraysnaturally produce linear output, from the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               log exposure X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  curve it is evident that the camera nonlinearly remaps the data, pre-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Figure4: Theresponse functionoftheDCS460recoveredbyoural-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sumablytomimictheresponsecurvesfoundinﬁlm. Theunderlying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 gorithm, with the underlying ( E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             i                                                                                        t                           j                               ;Z                                                                                    ij                                                     )                                              data shown as light cir-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  registered ( E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t                                                           ;Z                                                                                                                                           )                                                 data are shown as light circles underneath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cles. The logarithm is base e .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    i                                                                                                                     j                                                                                                                     ij
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  the curve; some outliers are due to sensor artifacts (light horizontal
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  bands across some of the darker images.)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Fig. 5showsthereconstructedhighdynamicrangeradiancemap.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  To display this map, we have taken the logarithm of the radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  values and mapped the range of these values into the range of the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  display. In this representation, the pixels at the light regions do not
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  saturate, and detail in the shadow regions can be made out, indicat-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ing that all of the information from the original image sequence is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  present in the radiance map. The large range of values present in
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  the radiance map (over four orders of magnitude of useful dynamic
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  range) is shown by the values at the marked pixel locations.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Figure 6 shows sixteen photographs taken inside a church with a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Canon35mmSLRcameraonFuji100ASAcolorprintﬁlm. Aﬁsh-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  eye15mmlenssetatf/8wasused,withexposuretimesrangingfrom
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  30 seconds to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1                                                                                                        of a second in 1-stop increments. The ﬁlm was
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   developed professionally and scanned in using a Kodak PhotoCD
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ﬁlmscanner. The scanner was set so that it would not individually                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Figure 5: The reconstructed high dynamic range radiance map,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             9Note that here we are assuming that the spectral response functions for                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      mapped into a grayscale image by taking the logarithm of the ra-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   each channel of the two imaging processes is the same. Also, this technique                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             diance values. The relative radiance values of the marked pixel lo-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   does not model many signiﬁcant qualities of an imaging system such as ﬁlm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               cations, clockwise from lower left: 1.0, 46.2, 1907.1, 15116.0, and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   grain, chromatic aberration, blooming, and the modulation transfer function.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            18.0.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Figure 6: Sixteen photographs of a church taken at 1-stop increments from 30 sec to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1                                                                                                     sec. The sun is directly behind the rightmost stained
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   glass window, making it especially bright. The blue borders seen in some of the image margins are induced by the image registration process.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Red                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Green
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     250
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       200                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     200
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       150                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     150
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       pixel value Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            pixel value Z
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     100
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      −10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 −5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        5                                                                                                                                                                                                                                                                                                                                                                                                         −10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 −5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   log exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          log exposure X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (a)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (b)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Blue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Red (dashed), Green (solid), and Blue (dash−dotted) curves
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     250
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       200                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     200
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       150                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     150
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       pixel value Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            pixel value Z
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     100
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      −10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 −5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        5                                                                                                                                                                                                                                                                                                                                                                                                                    −5                                                                                                                                                                                                                       −4                                                                                                                                                                                                                      −3                                                                                                                                                                                                                       −2                                                                                                                                                                                                                      −1                                                                                                                                                                                                                                              0                                                                                                                                                                                                                       1                                                                                                                                                                                                                        2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   log exposure X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          log exposure X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (c)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (d)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Figure 7: Recovered response curves for the imaging system used in the church photographs in Fig. 8.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (a-c) Response functions for the red,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   green, and blue channels, plotted with the underlying ( E i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              t                           j                               ;Z                                                                                    ij                                                     )                                                   data shown as light circles. (d) The response functions for red, green,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   and blue plotted on the same axes. Note that while the red and green curves are very consistent, the blue curve rises signiﬁcantly above the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   others for low exposure values. This indicates that dark regions in the images exhibit a slight blue cast. Since this artifact is recovered by the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   response curves, it does not affect the relative radiance values.
                                      (a)                                                 (b)                                                  (c)
                                      (d)                                                  (e)                                                 (f)
                 Figure 8: (a) An actual photograph, taken with conventional print ﬁlm at two seconds and scanned to PhotoCD.            (b) The high dynamic range
                 radiance map, displayed by linearly mapping its entire dynamic range into the dynamic range of the display device.            (c) The radiance map,
                 displayed by linearly mapping the lower 0 : 1%    of its dynamic range to the display device. (d) A false-color image showing relative radiance
                 values for a grayscale version of the radiance map, indicating that the map contains over ﬁve orders of magnitude of useful dynamic range.
                 (e) A rendering of the radiance map using adaptive histogram compression. (f)A rendering of the radiance map using histogram compression
                 and also simulating various properties of the human visual system, such as glare, contrast sensitivity, and scotopic retinal response. Images
                 (e) and (f) were generated by a method described in [23]. Images (d-f) courtesy of Gregory Ward Larson.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   adjust the brightness and contrast of the images10 to guarantee that
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   each image would be digitized using the same response function.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Anunfortunate aspect of the PhotoCD process is that it does not
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   scan precisely the same area of each negative relative to the extents
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   of the image.11 To counteract this effect, we geometrically regis-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tered the images to each other using a using normalized correlation
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (see [4]) to determine, with sub-pixel accuracy, corresponding pix-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   els between pairs of images.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Fig. 7(a-c) shows the response functions for the red, green, and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   blue channels of the church sequence recovered from 28 pixel loca-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tions. Fig. 7(d) shows the recovered red, green, and blue response
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   curves plotted on the same set of axes. From this plot, we can see
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   that while the red and green curves are very consistent, the blue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   curve rises signiﬁcantly above the others for low exposure values.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   This indicates that dark regions in the images exhibit a slight blue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cast. Since this artifact is modeled by the response curves, it will
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   not affect the relative radiance values.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Fig. 8 interprets the recovered high dynamic range radiance map                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (a) Synthetically blurred digital image
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   in a variety of ways. Fig. 8(a) is one of the actual photographs,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   which lacks detail in its darker regions at the same time that many
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   valueswithinthetworightmoststainedglasswindowsaresaturated.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Figs. 8(b,c)showtheradiancemap,linearlyscaledtothedisplayde-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   vice using two different scaling factors. Although one scaling fac-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tor is one thousand times the other, there is useful detail in both im-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ages. Fig. 8(d) is a false-color image showing radiance values for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   a grayscale version of the radiance map; the highest listed radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   value is nearly 250,000 times that of the lowest. Figs. 8(e,f) show
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   two renderings of the radiance map using a new tone reproduction
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   algorithm [23]. Although the rightmost stained glass window has
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   radiance values over a thousand times higher than the darker areas
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   in the rafters, these renderings exhibit detail in both areas.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Figure 9 demonstrates two applications of the techniques pre-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sented in this paper: accurate signal processing and virtual photog-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   raphy. The task is to simulate the effects of motion blur caused by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   moving the camera during the exposure. Fig. 9(a) shows the re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sults of convolving an actual, low-dynamic range photograph with
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   a 37                                                                                                                                                                                                                                               1                                                            pixel box ﬁlter to simulate horizontal motion blur. Fig.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   9(b) shows the results of applying this same ﬁlter to the high dy-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (b) Synthetically blurred radiance map
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   namic range radiance map, and then sending this ﬁltered radiance
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   map back through the recovered ﬁlm response functions using the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sameexposuretime  t asintheactualphotograph. Becauseweare
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   seeing this image through the actual image response curves, the two
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   left images are tonally consistent with each other. However, there is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   alargedifferencebetweenthesetwoimagesnearthebrightspots. In
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the photograph, the bright radiance values have been clamped to the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   maximumpixel values by the response function. As a result, these
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   clamped values blur with lower neighboring values and fail to satu-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   rate the image in the ﬁnal result, giving a muddy appearance.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      In Fig. 9(b), the extremely high pixel values were represented
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   properly in the radiance map and thus remained at values above the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   level of the response function’s saturation point within most of the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   blurred region. As a result, the resulting virtual photograph exhibits
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   several crisply-deﬁned saturated regions.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Fig. 9(c) is an actual photograph with real motion blur induced
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   by spinning the camera on the tripod during the exposure, which is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   equal in duration to Fig. 9(a) and the exposure simulated in Fig.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   9(b). Clearly, in the bright regions, the blurring effect is qualita-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (c) Actual blurred photograph
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tively similar to the synthetic blur in 9(b) but not 9(a). The precise                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Figure 9: (a) Synthetic motion blur applied to one of the origi-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   shape of the real motion blur is curved and was not modeled for this                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    nal digitized photographs. The bright values in the windows are
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   demonstration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          clamped before the processing, producing mostly unsaturated val-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     10This feature of the PhotoCD process is called “Scene Balance Adjust-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ues in the blurred regions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (b) Synthetic motion blur applied to
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ment”, or SBA.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          a recovered high-dynamic range radiance map, then virtually re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     11Thisisfarlessofaproblemforcinematic applications, inwhich theﬁlm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    photographed through the recovered ﬁlm response curves. The ra-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sprocket holes are used to expose and scan precisely the same area of each                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              diancevaluesareclampedtothedisplaydevice aftertheprocessing,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   frame.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  allowing pixels to remain saturated in the window regions. (c) Real
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           motionblurcreated by rotating the camera on the tripod during the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           exposure, which is much more consistent with (b) than (a).
                4 Conclusion                                                             [16] SCHLICK, C.      Quantization techniques for visualization of
                Wehavepresented a simple, practical, robust and accurate method               highdynamicrangepictures. In FifthEurographics Workshop
                ofrecoveringhighdynamicrangeradiancemapsfromordinarypho-                      on Rendering (Darmstadt, Germany) (June 1994), pp. 7–18.
                tographs. Our method uses the constraint of sensor reciprocity to        [17] SZELISK,IR. Image mosaicing for tele-reality applications.
                derive the response function and relative radiance values directly            In IEEE Computer Graphics and Applications (1996).
                from a set of images taken with different exposures. This work has       [18] TANI,T.Photographic sensitivity : theory and mechanisms .
                awidevarietyofapplicationsintheareasofimage-basedmodeling                     Oxford University Press, New York, 1995.
                and rendering, image processing, and image compositing, a few of         [19] THEUWISSEN,A.J.P.Solid-state imaging with charge-
                which we have demonstrated. It is our hope that this work will be             coupled devices.   Kluwer Academic Publishers, Dordrecht;
                abletohelpbothresearchersandpractitionersofcomputergraphics                   Boston, 1995.
                make muchmoreeffective use of digitized photographs.                     [20] TUMBLIN,J.,ANDRUSHMEIER, H. Tone reproduction for
                Acknowledgments                                                               realistic images. IEEE Computer Graphics and Applications
                                                                                              13, 6 (1993), 42–48.
                                                                                                 ARD, G. J. Measuring and modeling anisotropic reﬂection.
                The authors wish to thank Tim Hawkins, Carlo S´equin, David              [21] W
                Forsyth, Steve Chenney, Chris Healey, and our reviewers for their             In SIGGRAPH’92(July1992), pp. 265–272.
                valuable help in revising this paper. This research was supported by     [22] WARD, G. J. The radiance lighting simulation and rendering
                a Multidisciplinary University Research Initiative on three dimen-            system. In SIGGRAPH’94(July 1994), pp. 459–472.
                sionaldirectvisualizationfromONRandBMDO,grantFDN00014-                   [23] WARD,G.J.,USHMER          IER,H.,ANDPIATKO,C. Avisi-
                96-1-1200.                                                                    bility matching tone reproduction operator for high dynamic
                                                                                              range scenes. Tech. Rep. LBNL-39882, Lawrence Berkeley
                References                                                                    National Laboratory, March 1997.
                 [1] ADAMS,A.Basic Photo, 1st ed.             Morgan & Morgan,           A MatlabCode
                     Hastings-on-Hudson, New York, 1970.
                 [2] CHEN, E. QuickTime VR - an image-based approach to vir-             Here is the MATLABcode used to solve the linear system that min-
                     tual environment navigation. In SIGGRAPH ’95 (1995).                imizes the objective function O  in Equation 3. Given a set of ob-
                 [3] DEBEVEC,P.E.,TAYLOR,C.J.,ANDMALIK, J. Model-                        served pixel values in a set of images with known exposures, this
                     ing and rendering architecture from photographs: A hybrid           routine reconstructs the imaging response curve and the radiance
                     geometry- and image-based approach.      In SIGGRAPH ’96            values for the given pixels. The weighting function w ( z ) is found
                     (August 1996), pp. 11–20.                                           in Equation 4.
                      AUGERAS,O.Three-Dimensional Computer Vision.MIT
                 [4] F
                     Press, 1993.
                                                                                           %
                 [5] FERWERDA,J.A.,PATTANAIK,S.N.,HSIRLEY,P.,AND                           % gsolve.m − Solve for imaging system response function
                                                                                           %
                     GREENBERG,D.P. Amodelofvisualadaptationforrealistic                   % Given a set of pixel values observed for several pixels in several
                                                                                           % images with different exposure times, this function returns the
                     image synthesis. In SIGGRAPH ’96 (1996), pp. 249–258.                 % imaging system’s response function g as well as the log film irradiance
                                                                                           % values for the observed pixels.
                 [6] GORTLER,S.J.,GRZESZCZUK,R.,SZELISK,RI .,ANDCO-                        %
                                                                                           % Assumes:
                                                                                           %
                     HEN, M. F.     The Lumigraph.     In SIGGRAPH ’96 (1996),             %  Zmin = 0
                                                                                           %  Zmax = 255
                     pp. 43–54.                                                            %
                                                                                           % Arguments:
                 [7] HORN,B.K.P.RobotVision. MITPress,Cambridge,Mass.,                     %
                                                                                           %  Z(i,j) is the pixel values of pixel location number i in image j
                     1986, ch. 10, pp. 206–208.                                            %  B(j)   is the log delta t, or log shutter speed, for image j
                                                                                           %  l      is lamdba, the constant that determines the amount of smoothness
                                                                                           %  w(z)   is the weighting function value for pixel value z
                 [8] JAMES,T.,Ed.The Theory of the Photographic Process .                  % 
                                                                                           % Returns:
                     Macmillan, New York, 1977.                                            %
                                                                                           %  g(z)   is the log exposure corresponding to pixel value z
                                                                                           %  lE(i)  is the log film irradiance at pixel location i
                 [9] KAUFMAN,J.E.,Ed.IESLighting Handbook; the standard                    %
                     lighting guide, 7th ed. Illuminating Engineering Society, New         function [g,lE]=gsolve(Z,B,l,w)
                     York, 1987, p. 24.                                                    n = 256;
                [10] KOLB,C.,MITCHELL,D.,ANDHANRAHAN, P. A realis-                         A = zeros(size(Z,1)*size(Z,2)+n+1,n+size(Z,1));
                                                                                           b = zeros(size(A,1),1);
                     tic camera model for computer graphics. In SIGGRAPH ’95               %% Include the data−fitting equations
                     (1995).                                                               k = 1;
                                                                                           for i=1:size(Z,1)
                [11] LAVEAU,S.,ANDFAUGERAS, O. 3-D scene representation                      for j=1:size(Z,2)
                                                                                               wij = w(Z(i,j)+1);
                     asacollectionofimages. InProceedingsof12thInternational                   A(k,Z(i,j)+1) = wij;  A(k,n+i) = −wij;       b(k,1) = wij * B(i,j);
                                                                                               k=k+1;
                     Conference on Pattern Recognition (1994), vol. 1, pp. 689–              end
                     691.                                                                  end
                                                                                           %% Fix the curve by setting its middle value to 0
                [12] LEVOY,M.,ANDHANRAHAN, P. Light ﬁeld rendering. In                     A(k,129) = 1;
                     SIGGRAPH’96(1996), pp. 31–42.                                         k=k+1;
                                                                                           %% Include the smoothness equations
                [13] MADDEN, B. C. Extended intensity range imaging. Tech.                 for i=1:n−2
                                                                                             A(k,i)=l*w(i+1);        A(k,i+1)=−2*l*w(i+1);  A(k,i+2)=l*w(i+1);
                     rep., GRASP Laboratory, University of Pennsylvania, 1993.               k=k+1;
                [14] MANN,S.,ANDPICARD, R. W. Being ’undigital’ with dig-                  end
                                                                                           %% Solve the system using SVD
                     ital cameras: Extending dynamic range by combining differ-            x = A\b;
                     ently exposed pictures. In Proceedings of IS&T 46th annual            g = x(1:n);
                     conference (May 1995), pp. 422–428.                                   lE = x(n+1:size(x,1));
                [15] MCMILLAN,L.,ANDBISHOP, G. Plenoptic Modeling: An
                     image-based rendering system. In SIGGRAPH ’95 (1995).
