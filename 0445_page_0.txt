                                                                                                                                                                                                                                                                                          en:µKanr    A           Minimal      Functional  eCor
                                                                                                                                                                                                                                                                                                                                                             orf         Relational  ogrammingPr
                                                                                                                                                                                                                                                                                                                                                                                             Jason Hemann                      Daniel.PFriedman
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IndianaersityvUni
                                                                                                                                                                                                                                                                                                                                                                                                                                  {jhemann,dfried}@cs.indiana.edu
                                                                                                Abstract                                                                                                                                                                                                                                                                                                                                                                                                                                                                       the  ssystem'internalsaremademanifest.Whatismore,by
                                                                                                This  paper presentsµKanren,aminimalistlanguageinthe                                                                                                                                                                                                                                                                                                                                                                                                                           re-adjudicatingwhatfunctionsareproperlythewpurvieof
                                                                                                miniKanrenamilyfof  relational(logic)programminglan-                                                                                                                                                                                                                                                                                                                                                                                                                           the end,userweelopvdeanimplementationthatweighsinat
                                                                                                guages.Itsimplementationcompriseswerfethan40linesof                                                                                                                                                                                                                                                                                                                                                                                                                            39   linesof Scheme.Thepresentationofthelanguageandits
                                                                                                Scheme.eWatevmotitheneedfora minimalistminiKanren                                                                                                                                                                                                                                                                                                                                                                                                                              featuresws.folloThecompleteimplementationofµKanren
                                                                                                language,andelyviteratielopvdeacompletesearch.gystrate                                                                                                                                                                                                                                                                                                                                                                                                                         is   foundin  the appendix.
                                                                                               ,Finallywe      demonstratethat throughcientsufelv-leuser
                                                                                                featuresone    ainsgremuch    of     the    enessvxpressieofother                                                                                                                                                                                                                                                                                                                                                                                                              2.                   The  enµKanrLanguage
                                                                                                miniKanrenlanguages.Inouropinionits vitybreand  sim-                                                                                                                                                                                                                                                                                                                                                                                                                           Herein,webrieydescribethesyntaxofµKanrenprograms,
                                                                                                ple semanticsemakµKanrenuniquelyant.gele                                                                                                                                                                                                                                                                                                                                                                                                                                       with  a     focus on   those areas in   which µKanrenfersdiffrom
                                                                                                Categories  and         Subject     Descriptors                                                                                                                                                                                                                                                       D.3.2       [                                            egLangua                                                                                                        earlierminiKanrenlanguages.Readersintimatelyamiliarf
                                                                                                Classications                                                                                         ]:      evApplicati(functional)languages,Con-                                                                                                                                                                                                                                                                                                                           with miniKanrenprogrammingmaylightlyperusethissec-
                                                                                                straintandlogiclanguages                                                                                                                                                                                                                                                                                                                                                                                                                                                       tion;readersseekingathoroughintroductiontominiKanren
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               programmingaredirectedto Byrd   [                                                                                                                                                                                                                                   3        ]     and   Friedmanet.  al
                                                                                               ordseywK                                                                                miniKanren,relationalprogramming,logicpro-                                                                                                                                                                                                                                                                                                                                              [     4        ],  from whichthe presentdiscussionisadapted.
                                                                                                gramming,Scheme                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     A     µKanrenprogramproceedsthroughtheapplicationof
                                                                                                1.                  oductionIntr                                                                                                                                                                                                                                                                                                                                                                                                                                               a             goal                                to    a                          state                            .    Goals are  often understoodbyanalogyto
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               predicates.Whereastheapplicationofapredicatetoanele-
                                                                                                miniKanrenistheprincipalmemberofanymouseponam-f                                                                                                                                                                                                                                                                                                                                                                                                                                mentof   its domaincanbe eithertrueoralse,fa goalpursued
                                                                                                ily    of     relational(logic)programminglanguages.yManof                                                                                                                                                                                                                                                                                                                                                                                                                     in    a    envgistatecan   either                                                                                                                                                            succeed                                                       or                  fail                   .    A    sgoal'success
                                                                                                its criticaldesigndecisionsareareactiontothoseofProlog                                                                                                                                                                                                                                                                                                                                                                                                                         may  resultina   sequenceofged)(enlarstates,whichweterm
                                                                                                and  otherwnwell-kno5th-generationlanguages.Oneofthe                                                                                                                                                                                                                                                                                                                                                                                                                           a           eamstr                                              [     12               ]. e W use  functionstosimulaterelations.An-ar
                                                                                               erencesfdifis that,   while  a      typicalProlog implementation                                                                                                                                                                                                                                                                                                                                                                                                                bitrary                                            n-ary relation   is wedvieasan                                                                                                                                                                                (n−1)-ary partial func-
                                                                                                might be    thousandsof  lines of    C      code, a     miniKanrenlan-                                                                                                                                                                                                                                                                                                                                                                                                         tion,  mappingtuplesof     domainelementsinto a      linearized
                                                                                                guage   is      usually implementedin   wheresomeunder  1000                                                                                                                                                                                                                                                                                                                                                                                                                   submultisetofelementsofthecodomainervowhichtheini-
                                                                                                lines.  Though   there    are     miniKanrenlanguagesof     ariedv                                                                                                                                                                                                                                                                                                                                                                                                             tial relationholds.Aenvgicollectionofgoalsmaybesatis-
                                                                                                sizesand   featuresets(see                                                                                                                                                                    http://miniKanren.org                                                                                                                                                                             ),    the                                                                      ed by   zeroor  morestates.Theresultofa µKanrenprogram
                                                                                                originalpublishedimplementationasw265linesofScheme                                                                                                                                                                                                                                                                                                                                                                                                                             is    a    streamof  satisfyingstates.Thestreammaybenite or
                                                                                                code.In  thosewfe lines,it  videsproanenessvxpressiecom-                                                                                                                                                                                                                                                                                                                                                                                                                       innite,as there may  be    niteor    innitelyymansatisfying
                                                                                                parableto      that    of     an      implementationofa      pure   subset  of                                                                                                                                                                                                                                                                                                                                                                                                 states.
                                                                                                Prolog.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             A    sprogram'resultingstreamthusdependsonthegoals
                                                                                                                   e W     gue,ar though, that   deeply uriedb  within that    265-                                                                                                                                                                                                                                                                                                                                                                                            that comprisethatprogram.InµKanrentherearefourprim-
                                                                                                line miniKanrenimplementationisasmall,beautiful,rela-                                                                                                                                                                                                                                                                                                                                                                                                                          eviti goal  constructors:                                                                                                                                                  ≡, call/fresh                                                                                                           ,         disj                                 ,      and                                 conj                                 .
                                                                                                tionalprogramminglanguageseekingtogetout.eWevbelie                                                                                                                                                                                                                                                                                                                                                                                                                             The                             ≡ goal constructor           is  the primaryorkhorsewofthesys-
                                                                                                µKanrenis    that   language.By  minimizingtheoperatorsto                                                                                                                                                                                                                                                                                                                                                                                                                      tem;   goals  constructedfrom                                                                                                                                                                                      ≡ succeed                     when   the    otw   -ar
                                                                                                those  strictlynecessaryto  do     relationalprogrammingand                                                                                                                                                                                                                                                                                                                                                                                                                    guments                                                           unify                                    [    1        ].    The   successof  goals uiltbfrom                                                                                                                                                                                                                  ≡ may
                                                                                                placingmuchof  the  aceinterfdirectlyunderthesuser'con-                                                                                                                                                                                                                                                                                                                                                                                                                        causethe stateto.wgroeUnliktheimplementationof                                                                                                                                                                                                                                                                                                                                             ≡ de-
                                                                                                trol, we   evha  furthersimpliedtheimplementationandil-                                                                                                                                                                                                                                                                                                                                                                                                                       tailed in     Friedmanet.   al     [                                                                                                                                                          4        ],     that   presentedheredoes   not
                                                                                                luminatedthe role   and    interrelationshipsoftheremaining                                                                                                                                                                                                                                                                                                                                                                                                                    prohibitcircularitiesinthesubstitution.
                                                                                                components.Bymakingthe  implementationentirelyfunc-                                                                                                                                                                                                                                                                                                                                                                                                                                                 The                              call/fresh                                                                                        goal  constructorcreatesafreshw)(ne
                                                                                                tionaland oidvdeof    macros,heretoforeopaquesectionsof                                                                                                                                                                                                                                                                                                                                                                                                                        logicariable.v                                                                                          call/fresh                                                                                 s'  solegumentarisaunaryfunc-
