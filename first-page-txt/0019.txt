                                                                                                                                                           ~
                 Discrete Mathematics 27 (1979) 47-57.
                 @North-Holland Publishing Comp~ny
 r.                                                                                                                                                        ill
 I
 I'                     BOUNDS             FOR SORTING BY PREFIX REVERSAL
                        William H. GATES
                        Microsoft, Albuquerque, New Mexico
       !                Christos H. PAPADIMITRIOU*t
 f:                      DepartmentofElectricalEngineering,Universityof California,Berkeley,CA 94720,U.S.A.
 ~
                        Received 18danuary        1978
                        Revised 28 August 19(8                                                                                                              III
                                                                                                                                       .,
                           For a permutation      (J"of the integers from 1 to n, let f((J")be the smallest number of prefix                             ;, ;1
                        reversalsthal'will   transform (J"to the identity permutation,       and let f(n) be the largest such f(lr)
                        for all (J"in (the symmetric group) Sn' We show that f(n) "'"(5n + 5)/3, and that f(n) ~ 17n/16 for
                        n a multiple of 16. if, furthermore,      each integer is required to participate in an even number of
                        reversed prefixes, the corresponding function g(n) is shown to obey 3n/2-1""'g(n)""'2n+3.
                 1. Introduction
                    We introduce OUEproblem by the following quotation from [1]
                              The chef in our place is sloppy, and when he prepares a stack of pancakes they come
                           out all different sizes. Therefore, when I qeliver them to a customer, on the way to the
                           table I rearrange them (so that the smallest winds up on top, and so on, down to the
                           largest"at the bottom) by grabbing several from the top and flipping them over, r~peating
                           this (varying the number I flip) as many times as necessary. If there are n pancakes, what
                           is the, maximum nUmber of flips (as a function f(n) of n) that I will ever.have to use to
                           rearrange    them?                                                                                                       ~
                    In this paper we derive upper and~lower bounds for fen).Certain bounds were
                 already known. For example, consider any stack of pancakes. An adjacency in
                 this stack is a pair of pancakes that are adjacent in the stask, and such that no
                 other pancake has size intermediate~ between the two. If the largest pancake is on
                 the bottom, this also counts as one extra adjacency. Now, fOL;n ~4 there""'are                                                            1
 i               stacks of n pancakes that have no adjaceIJcies whatsoever. On the other hand, "a                                            '"
                 sorted stack must have all n adjacencies and each move (flip) can create'at                                     most
                 one adja~ency. Consequently,                  forn     ~4,    f(n)~    n.. By elaborating          on this argu-
                 ment, M.R. Garey, D.S. Johnso-qand S. Lin [2] showed tl1atfen) ~ n+ 1dor n"F6.
  [                 For upper bounds-algorithms,                   that is"it      was knqwn that fen) ~ 2n. This can
 :     I         be seen as follows. Given any stack we may start by bringing the largest pancake
 I             . on top and then flip the whole stack: the largest pancake is now :;ttthe bottom,
 I                  *ResearchsupportedbyNSFGrant MCS77-01193.                                                                                              ;II
                    t Current address: Laboratory for Computer Science, Massachusets, Institute of ?Technology,
                 Cambr.idge,Ma 02139, USA.                                                                                  ~                              ..
                                        -0
   "                                                                     47
                                                                                                                                                           11
                                                                                                                                                           ..11
                                                                                                                                                  ii!      ;II
                                                                                                                                                           :11
 .;                                                                                                                                                        ~
 Ie                                               "'"
