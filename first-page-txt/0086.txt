                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    he hniscec    T                                                                                                                                        at                                               akult  F                                                                                                                                                            Sepp LONG                                                                               at                                               ersitUniv                                          ur                         Neural               f Hohreiterc                                                                                                                                             Informatik                          T-TERM     SHOR                                                                      tion a    Comput                                                                    henunc                                             M                                                                                                                                                                                                                                                                                                                                                                                                       9(8):1735{1780,                                                                                                                                                                                                                                                                                                                                  Y          MEMOR                                                                                                       urgen                                           J                                                                                Corso    1997                                                                                                                                                                                                               IDSIA        ub hmidherSc                             eziaElv                                                                                                                                                                                                                                                                                                                                             36
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       hen.de/~hohreituenccttp://www7.informatik.tu-mh                             hen.deuenchohreit@informatik.tu-mcLearning                                                                                                                                                                                             80290                                                                                                   to                                                                                           store                       hen,unc                                            M                                                                                                          information                                                                                                                                                                                                                                                                                                                                        y  German                                                               erv o                                                                                                                                                                   extended                                                                                   Abstract                                                                                                                                                                                                                                  time                                                                                                                                                                    als tervin                                                                                                                                                                                    6900                                          h/~juergenttp://www.idsia.ch                                                 via                                                                     h  juergen@idsia.c               Lugano,          t recurren                                                                                                                                                                                                                                                                                                                                 kpropagationbac            Switzerland
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             estak                                                                                                                                                                                               a                                                          eryv                                                                                                                                                                    long                                                                                                                                                                time,                                                                                                                                                                                             mostly                                                                                                                                                                                                                                                 due                                                                                                                                            to                                                                                       t,insucien                                                                                                                                                                                                                                                                                                                                                                                                           yingdeca                                                                                                                                                                                                                                                                                                                   error                                                                                                                                                                                  k bac                                                                                                                                                                            w.o                                                                                                                                                                                     e     W                                                                                                                                briey                                                                                                                                                                                                                                     review
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Hohreiter'sc                                                                                                                                                                                                                                                                                                                                                                                                                                     1991                                                                                                                                                                                   analysis                                                                                                                                                                                                                                                                                            of                                                                                         this                                                                                                                                                      problem,                                                                                                                                                                                                                                                                                                                            then                                                                                                                                                                               address                                                                                                                                                                                                                                                                               it                                                                            y b                                                                                                            troinducing                                                                                                                                                                                                                                                                                                                                                                                                                    a                                                               el,vno                                                                                                                                                                                                                            t,ecien
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t-basedgradien                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     method                                                                                                                                                                                                                                                                                called                                                                                                                                                                                                                  \Long                                                                                                                                                                                                                           erm   Short-T                                                                                                                                                                                                                                                                                                                                                                                                                    Memory"                                                                                                                                                                                                                                                                                                                                             (LSTM).                                                                                                                                                                                                                                                                                                                     runcatingT                                                                                                                                                                                                                                                                                                                                                                                                     the                                                                                                                              t gradien
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               where                                                                                                                                                                                                                         this                                                                                                                                                  does                                                                                                                                                                          not                                                                                                                                      do                                                                                                         harm,                                                                                                                                                                                                                          LSTM                                                                                                                                                                                                                                              can                                                                                                                                           learn                                                                                                                                                                                           to                                                                                             bridge                                                                                                                                                                                                                                     minimal                                                                                                                                                                                                                                                                                                    time                                                                                                                                                                            lags                                                                                                                                                      in                                                                                        excess                                                                                                                                                                                                                                of                                                                                      1000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               discrete                                                                                                                                                                                                                                                                            time                                                                                                                                                                      steps                                                                                                                                                                                     y b                                                                                                    enforcing                                                                                                                                                                                                                                                                                                                         onstantc                                                                                                                                                                                                                                                                                                      error                                                                                                                                                                                w o                                                                                                                                                         through                                                                                                                                                                                                                                                                                    t \constan                                                                                                                                                                                                                                                                                                                                               error                                                                                                                                                                                  carrousels"                                                                                                                                                                                                                                                                                                                                                                                         within
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               special                                                                                                                                                                                                                                                      units.                                                                                                                                                                                                                                 e Multiplicativ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   gate                                                                                                                                                                      units                                                                                                                                                                                               learn                                                                                                                                                                                              to                                                                                                open                                                                                                                                                                                         and                                                                                                                                                      close                                                                                                                                                                                      access                                                                                                                                                                                                                                to                                                                                                the                                                                                                                                   t constan                                                                                                                                                                                                                                                                                                                  error
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             w.o                                                                                                                                                                                          LSTM                                                                                                                                                                                                                                         is                                                                       local                                                                                                                                                                            in                                                                                  space                                                                                                                                                                                                    and                                                                                                                                              time;                                                                                                                                                                                            its                                                                                                   computational                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        y complexit                                                                                                                                                                                                                                                                                                                                                                                         p er                                                                                                                              time                                                                                                                                                                      step                                                                                                                                                          and                                                                                                                                          t eighw
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               is                                                                        O                                                           (1).                                                                                                                                                     Our                                                                                                                                                        exptserimen                                                                                                                                                                                                                                                                                                                                                                                                                                with                                                                                                                                                                        articial                                                                                                                                                                                                                                                                                                   data                                                                                                                                                                  e olvvin                                                                                                                                                                                                                                                             local,                                                                                                                                                                                                  distributed,                                                                                                                                                                                                                                                                                                                                                                                                            alued,real-v                                                                                                                                                                                                                                                                                                                                                                                                                  and                                                                                                                                               noisy
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               pattern                                                                                                                                                                                                                                                                      tations.represen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    In                                                                                            comparisons                                                                                                                                                                                                                                                                                                                                                                                                                                        with                                                                                                                                                                   TRL,  R                                                                                                                                                                                                                                                              BPTT,                                                                                                                                                                                                                                                                t Recurren                                                                                                                                                                                                                                                                                                                                                            Cascade-Correlation,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Elman                                                                                                                                                                                                                                              nets,                                                                                                                                                                                  and                                                                                                                                                 Neural                                                                                                                                                                                                                                                  Sequence                                                                                                                                                                                                                                                                                                                                unking,Ch                                                                                                                                                                                                                                                                                                                                                                           LSTM                                                                                                                                                                                                                                             leads                                                                                                                                                                                           to                                                                                        y man                                                                                                                                                                                                             more                                                                                                                                                                                           successful                                                                                                                                                                                                                                                                                                                                                  runs,                                                                                                                                                                                           and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               learns                                                                                                                                                                                                                     h ucm                                                                                                                                                                                                             faster.                                                                                                                                                                                                                                              LSTM                                                                                                                                                                                                                                               also                                                                                                                                                     essolv                                                                                                                                                                                                                        complex,                                                                                                                                                                                                                                                                                                                            articial                                                                                                                                                                                                                                                                                                       long                                                                                                                                                                   time                                                                                                                                                                            lag                                                                                                                          tasks                                                                                                                                                                                               that                                                                                                                                                                e v ha                                                                                                                                                                              ernev
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1                                                                                                                                                                                                     ODUCTIONINTRbeen                                                                                                                                                                             edsolv                                                                                                                                                                                                                                 y b                                                                                                         previous                                                                                                                                                                                                                                                                                                        t recurren                                                                                                                                                                                                                                                                                                                               orkwnet                                                                                                                                                                                                                                                                                                  algorithms.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t Recurren                                                                                                                                                                                                                                                                                                                                                                                                 orkswnet                                                                                                                                                                                                                                                                                                                                                                   can                                                                                                                                                               in                                                                                                         principle                                                                                                                                                                                                                                                                                                                                                       use                                                                                                                                                       their                                                                                                                                                                                                          k feedbac                                                                                                                                                                                                                                                                                                                                                      connections                                                                                                                                                                                                                                                                                                                                                                                                                                                               to                                                                                                             store                                                                                                                                                                                                               tationsrepresen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t recen                                                                                                                                                                                                                                                 input                                                                                                                                                                                                                  tsenev                                                                                                                                                                                                                                                         in                                                                                             form                                                                                                                                                                                               of                                                                                      ationsactiv                                                                                                                                                                                                                                                                                                                                                                                                                           (\short-term                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       memory",                                                                                                                                                                                                                                                                                                                                                                                         as                                                                                                  opposed                                                                                                                                                                                                                                                                                                                         to                                                                                                  \long-term                                                                                                                                                                                                                                                                                                                                                                                                                        mem-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ory"                                                                                                                                                                                    b emodied                                                                                                                                                                                                                                                                                                                                                                               y b                                                                                                               wlyslo                                                                                                                                                                                                                                                   hangingc                                                                                                                                                                                                                                                                                                                                                  ts).eighw                                                                                                                                                                                                                                                                                                                                                                   This                                                                                                                                                                                         is                                                                                 ptiallyoten                                                                                                                                                                                                                                                                                                                                                                                                                    t signican                                                                                                                                                                                                                                                                                                                                                                                                 for                                                                                                                          y man                                                                                                                                                                                                                              applications,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               including                                                                                                                                                                                                                                                                                                                                                                     spheec                                                                                                                                                                                                                                                                       processing,                                                                                                                                                                                                                                                                                                                                                                                                                               vianonon-Mark                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         trol,con                                                                                                                                                                                                                                                                                                                and                                                                                                                                                                  usicm                                                                                                                                                                                                                                             composition                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (e.g.,                                                                                                                                                                                                                 Mozer                                                                                                                                                                                                                                                             1992).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               The                                                                                                                                                                            most                                                                                                                                                                                                           widely                                                                                                                                                                                                                                                                  used                                                                                                                                                                                              algorithms                                                                                                                                                                                                                                                                                                                                                                                                                     for                                                                                                                                learning                                                                                                                                                                                                                                                                                                                          what                                                                                                                                                                                                   to                                                                                                        put                                                                                                                                                         in                                                                                                  short-term                                                                                                                                                                                                                                                                                                                                                                                                               ,      memory                                                                                                                                                                                                                                                                                                                                         er,evwho                                                                                                                                                                                                                                                                                                                                                       e tak
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               too                                                                                                                                           h ucm                                                                                                                                                                                                                             time                                                                                                                                                                                          or                                                                                                     do                                                                                                                  not                                                                                                                                                orkw                                                                                                                                                                                                        ellw                                                                                                                                                                       at                                                                                                    all,                                                                                                                                        especially                                                                                                                                                                                                                                                                                                                                                                             when                                                                                                                                                                                                                      minimal                                                                                                                                                                                                                                                                                                                            time                                                                                                                                                                                          lags                                                                                                                                                                  eenbwet                                                                                                                                                                                                                                                                                                                            inputs                                                                                                                                                                                                                                                         and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               corresponding                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            herteac                                                                                                                                                                                                                                                                                                 signals                                                                                                                                                                                                                                                                           are                                                                                                                                              long.                                                                                                                                                                                                                                Although                                                                                                                                                                                                                                                                                                                                                                            theoretically                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      fascinating,                                                                                                                                                                                                                                                                                                                                                                                                                                                    existing                                                                                                                                                                                                                                                                                                                 methods                                                                                                                                                                                                                                                                                                                                             do
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               not                                                                                                                                                  videpro                                                                                                                                                                                                                                                                                                       clear                                                                                                                                                                                             al  acticpr                                                                                                                                                                                                                                                                                                                                      tagesanadv                                                                                                                                                                                                                                                                                                                                                                                                                                      er,vo                                                                                                                                                                                                   ,      y sa                                                                                                                                                                 kpropbac                                                                                                                                                                                                                                                                                                                                                                     in                                                                                                 ardfeedforw                                                                                                                                                                                                                                                                                                                                                                                                                                                             nets                                                                                                                                                                               with                                                                                                                                                                                             limited                                                                                                                                                                                                                                                                                       time
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ws.windo                                                                                                                       The                                                                                                                                                                                            problem.                                           This                                                                                                                                                                                          paper                                                                                                                                                               With                                                                 will                                                                                                                                    tionalenvcon         review                                                                                                                                                                                                                                                               an                                                                                                                 analysis                                                                           k-Propagation\Bac                                                                                                                                                                                                                    of                                                                                             the                                                                                                                                            problem                                                                                                                                                                                                                                                    Through                                                                 and                                                                                                                                                              suggest                                                                                                  Time"                                                                                                                                                                                      a                                                             .     (BPTT,remedy                                                                                                                                                                                                                                                                                                               e.g.,                                                                                                                                                                       Williams
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               and                                                                                                                                                                   Zipser                                                                                                                                                                                                                                                         1992,                                                                                                                                                                                                                   erbos  W                                                                                                                                                                                                                                                                                                              1988)                                                                                                                                                                                                                                  or                                                                                                         \Real-Time                                                                                                                                                                                                                                                                                                                                                                                                                                                         t Recurren                                                                                                                                                                                                                                                                                                                                                                                                Learning"                                                                                                                                                                                                                                                                                                                                                                                          TRL,   (R                                                                                                                                                                                                                                                                                                                         e.g.,                                                                                                                                                                                Robinson                                                                                                                                                                                                                                                                                                                                                                           and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        allsideF                                                                                                                                                                                                                                                                                                           1987),                                                                                                                                                                                                                                                  error                                                                                                                                                                                                      signals                                                                                                                                                                                                                                                                  wing\o                                                                                                                                                                                                                                                                                                                           ardskwbac                                                                                                                                                                                                                                                                                                                                                                                                               in                                                                                             time"                                                                                                                                                                                                                                 tend                                                                                                                                                                                        to                                                                                                  either                                                                                                                                                                                                                                     (1)                                                                                                                               w blo                                                                                                                                                                                                up                                                                                                                     or                                                                                                   (2)                                                                                                                            anish:v
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               the                                                                                                                                                         temporal                                                                                                                                                                                                                                                                                                                                                                    olutionev                                                                                                                                                                                                                                                                                                                                                                              of                                                                                                          the                                                                                                                                                       kpropagatedbac                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         error                                                                                                                                                                                                                   exptiallyonen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                depends                                                                                                                                                                                                                                                                                                                                       on                                                                                                                               the                                                                                                                                                         size                                                                                                                                                                      of                                                                                                          the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           tseighw                                                                                                                                                                                                                                                                                                     (Hohreiterc                                                                                                                                                                                                                                                                                                                                                                                                                                               1991).                                                                                                                                                                                                                                                               Case                                                                                                                                                                                                    (1)                                                                                                                                 y ma                                                                                                                                                                                   lead                                                                                                                                                                            to                                                                                                    oscillating                                                                                                                                                                                                                                                                                                                                                                                           ts,eighw                                                                                                                                                                                                                                                                                                                           while                                                                                                                                                                                                                     in                                                                                                case                                                                                                                                                                            (2)                                                                                                                                    learning                                                                                                                                                                                                                                                                                                                       to
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               bridge                                                                                                                       The                                                                                                                              long                                                            .       remedy                                                                                                      time                                                                                                                                                                                         lags                                                                                This                                                                            estak                                                                                                              paper                                                                                               a                                                                  e prohibitiv                                                         tspresen                                                                                                                                                                                                                                                                                                                             ong \L                    t amoun                                                                                                                                                                                                                         erm   Short-T                                                                   of                                                                                             time,                                                                                                                                                                                                               or                                                                      Memory"                       does                                                                                                                                                                                       not                                                                                                                                               orkw       (LSTM),                                                                                                                                                                                           at                                                                                                   all                                                        a                                                        (see          elv no                                                                                                                                                  section                                                               t recurren                                                                                                                                                                                                     3).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           orkwnet                                                                                                                                                                                                                                                                                                                hitecturearc                                                                                                                                                                                                                                                                                                                                                                                                                                                          in                                                                                       conjunction                                                                                                                                                                                                                                                                                                                                                                                                                                               with                                                                                                                                                                                  an                                                                                                          appropriate                                                                                                                                                                                                                                                                                                                                                                                                                                            t-basedgradien                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         learning                                                                                                                                                                                                                                                                                                               algorithm.                                                                                                                                                                                                                                                                                                                                                                                                              LSTM
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               is                                                                                      designed                                                                                                                                                                                                                                                                                                                                             to                                                                                                    ercomevo                                                                                                                                                                                                                                                                                                                                                                           these                                                                                                                                                                                                                    error                                                                                                                                                                                                      w k-obac                                                                                                                                                                                                                                                                                                                                                                              problems.                                                                                                                                                                                                                                                                                                                                                                                                         It                                                                                            can                                                                                                                                                         learn                                                                                                                                                                                                               to                                                                                                        bridge                                                                                                                                                                                                                                                            time                                                                                                                                                                                       als  tervin                                                                                                                                                                                                                                                                                                                                             in
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               excess                                                                                                                                                                                                                                                      of                                                                                                 1000                                                                                                                                                                                                   steps                                                                                                                                                                                                              enev                                                                                                                                                                                               in                                                                                                    case                                                                                                                                                                                of                                                                                          ,      noisy                                                                                                                                                                                                                                        incompressible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 input                                                                                                                                                                                                                             sequences,                                                                                                                                                                                                                                                                                                                                                                                                            without                                                                                                                                                                                                                                                                                                                  loss                                                                                                                                                               of                                                                                                 short
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               time                                                                                                                                                                                      lag                                                                                                                               capabilities.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    This                                                                                                                                                                                      is                                                                           edhievac                                                                                                                                                                                                                                                                                                                                     y b                                                                                                               an                                                                                                           t,ecien                                                                                                                                      1                                                                                                                                                                                         t-basedgradien                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             algorithm                                                                                                                                                                                                                                                                                                                                                                              for                                                                                                                        an                                                                                                            hitecturearc
