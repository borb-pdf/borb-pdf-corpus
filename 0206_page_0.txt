                       Cassandra-ADecentralizedStructured Storage System
                                                                  Avinash Lakshman                                 Prashant Malik
                                                                          Facebook                                      Facebook
                   ABSTRACT                                                                                 box Search is a feature that enables users to search through
                   Cassandra is a distributed storage system for managing very                              their Facebook Inbox. At Facebook this meant the system
                   large amounts of structured data spread out across many                                  wasrequiredtohandleaveryhighwritethroughput, billions
                   commodity servers, while providing highly available service                              of writes per day, and also scale with the number of users.
                   with no single point of failure. Cassandra aims to run on top                            Since users are served from data centers that are geograph-
                   of an infrastructure of hundreds of nodes (possibly spread                               ically distributed, being able to replicate data across data
                   across diﬀerent data centers). At this scale, small and large                            centers was key to keep search latencies down. Inbox Search
                   components fail continuously.               The way Cassandra man-                       was launched in June of 2008 for around 100 million users
                   ages the persistent state in the face of these failures drives                           and today we are at over 250 million users and Cassandra
                   the reliability and scalability of the software systems rely-                            has kept up the promise so far. Cassandra is now deployed
                   ing on this service. While in many ways Cassandra resem-                                 as the backend storage system for multiple services within
                   bles a database and shares many design and implementation                                Facebook.
                   strategies therewith, Cassandra does not support a full rela-                               This paper is structured as follows. Section 2 talks about
                   tional data model; instead, it provides clients with a simple                            related work, some of which has been very inﬂuential on our
                   data model that supports dynamic control over data lay-                                  design. Section 3 presents the data model in more detail.
                   out and format. Cassandra system was designed to run on                                  Section 4 presents the overview of the client API. Section
                   cheap commodity hardware and handle high write through-                                  5 presents the system design and the distributed algorithms
                   put while not sacriﬁcing read eﬃciency.                                                  that make Cassandra work. Section 6 details the experiences
                                                                                                            of making Cassandra work and reﬁnements to improve per-
                   1.     INTRODUCTION                                                                      formance. In Section 6.1 we describe how one of the appli-
                                                                                                            cations in the Facebook platform uses Cassandra. Finally
                      Facebook runs the largest social networking platform that                             Section 7 concludes with future work on Cassandra.
                   serves hundreds of millions users at peak times using tens of
                   thousands of servers located in many data centers around                                 2.     RELATEDWORK
                   the world.       There are strict operational requirements on
                   Facebook’s platform in terms of performance, reliability and                                Distributing data for performance, availability and dura-
                   eﬃciency, and to support continuous growth the platform                                  bility has been widely studied in the ﬁle system and database
                   needs to be highly scalable. Dealing with failures in an in-                             communities. Compared to P2P storage systems that only
                   frastructure comprised of thousands of components is our                                 support ﬂat namespaces, distributed ﬁle systems typically
                   standard mode of operation; there are always a small but                                 support hierarchical namespaces. Systems like Ficus[14] and
                   signiﬁcant number of server and network components that                                  Coda[16] replicate ﬁles for high availability at the expense
                   are failing at any given time. As such, the software systems                             of consistency. Update conﬂicts are typically managed us-
                   needtobeconstructedinamannerthattreatsfailuresasthe                                      ing specialized conﬂict resolution procedures. Farsite[2] is
                   norm rather than the exception. To meet the reliability and                              a distributed ﬁle system that does not use any centralized
                   scalability needs described above Facebook has developed                                 server. Farsite achieves high availability and scalability us-
                   Cassandra.                                                                               ing replication. The Google File System (GFS)[9] is another
                      Cassandra uses a synthesis of well known techniques to                                distributed ﬁle system built for hosting the state of Google’s
                   achieve scalability and availability. Cassandra was designed                             internal applications. GFS uses a simple design with a sin-
                   to fulﬁll the storage needs of the Inbox Search problem. In-                             gle master server for hosting the entire metadata and where
                                                                                                            the data is split into chunks and stored in chunk servers.
                                                                                                            However the GFS master is now made fault tolerant using
                                                                                                            the Chubby[3] abstraction. Bayou[18] is a distributed rela-
                                                                                                            tional database system that allows disconnected operations
                   Permission to make digital or hard copies of all or part of this work for                and provides eventual data consistency. Among these sys-
                   personal or classroom use is granted without fee provided that copies are                tems, Bayou, Coda and Ficus allow disconnected operations
                   not made or distributed for proﬁt or commercial advantage and that copies                and are resilient to issues such as network partitions and
                   bear this notice and the full citation on the ﬁrst page. To copy otherwise, to           outages. These systems diﬀer on their conﬂict resolution
                   republish, to post on servers or to redistribute to lists, requires prior speciﬁc        procedures. For instance, Coda and Ficus perform system
                   permission and/or a fee.
                   Copyright 200X ACMX-XXXXX-XX-X/XX/XX...$10.00.                                           level conﬂict resolution and Bayou allows application level
