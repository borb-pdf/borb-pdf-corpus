                                                                 draft of 5-11-2018
                      Self-encrypting deception: weaknesses in the
                              encryption of solid state drives (SSDs)
                                           Carlo Meijer                                          Bernard van Gastel
                               Radboud University, the Netherlands                      Radboud University, the Netherlands
                                         C.Meijer@cs.ru.nl                               Open University of the Netherlands
                                                                                          Bernard.vanGastel@{ru.nl,ou.nl}
                Abstract—We have analyzed the hardware full-disk encryption      full-disk encryption software built into Microsoft Windows,
             of several SSDs by reverse engineering their ﬁrmware. In theory,    switches off software encryption and completely relies on
             the security guarantees offered by hardware encryption are          hardware encryption by default if the drive advertises support.
             similar to or better than software implementations. In reality, we    Contribution. This paper evaluates both internal and external
             found that many hardware implementations have critical security     storage devices, from multiple vendors, adhering to standards
             weaknesses, for many models allowing for complete recovery of
             the data without knowledge of any secret.                           for secure storage. The vendors combined produce close to
                BitLocker, the encryption software built into Microsoft Win-     half of the SSDs currently sold. An overview is given of
             dows will rely exclusively on hardware full-disk encryption if      possible ﬂaws that apply in particular to hardware-based full-
             the SSD advertises supported for it. Thus, for these drives, data   disk encryption (Section V), and a methodology is provided for
             protected by BitLocker is also compromised.                         the analysis (Section IV). We have analyzed ﬁrmwares from
                This challenges the view that hardware encryption is prefer-
             able over software encryption. We conclude that one should not      different SSD models offering hardware encryption, focusing
             rely solely on hardware encryption offered by SSDs.                 on these ﬂaws (see Section VI and Table I). The analysis
                                   I. INTRODUCTION                               uncovers a pattern of critical issues across vendors. For multi-
                                                                                 ple models, it is possible to bypass the encryption entirely,
                In recent years, protection of sensitive data has received       allowing for a complete recovery of the data without any
             increased attention. Protection of digital data has become          knowledge of passwords or keys. The situation is worsened by
             a necessity, certainly in the light of new European Data            the delegation of encryption to the drive by BitLocker. Due to
             Protection Regulation. Technically, encryption is the go to         the default policy, many BitLocker users are unintentionally
             protection mechanism; it may be implemented in software             using hardware encryption, exposing them to the same threats.
             or hardware (or both). It can be applied on the level of            As such, we should reconsider whether hardware encryption
             individual ﬁles, or the entire drive, which is called full-disk     is a true successor to its software counterpart, and whether the
             encryption. Full-disk encryption is often the solution of choice    established standards actually promote sound implementations.
             as it takes away concerns of sensitive data leakage through,          Related work. At OHM in 2013, Domburg demonstrated
             for example, temporary ﬁles, page ﬁles and caches. Several          the possibility of debugging a hard drive through JTAG
             software solutions for full-disk encryption exist, and modern       and created possibly the ﬁrst publicly demonstrated hard
             operating systems typically integrate it as a feature. However,     drive ﬁrmware rootkit [4]. Domburg’s work has inspired
             purely software-based encryption has inherent weaknesses,           more research around anti-forensics such as [20], [7]. Leaked
             such as the encryption key being present in RAM at all times        documents indicate that even the NSA is using these tech-
             and performance drawbacks.                                          niques [11]. Besides, proprietary cryptographic systems have
                In an attempt to address these weaknesses, hardware full-        often shown to be much weaker in practice than standardized
             disk encryption is often proposed; the encryption is performed      publicly available alternatives once implementation details
             within the drive itself, thereby conﬁning the encryption key        are uncovered [18]. Within the scope of storage devices
             exclusively to the drive. Typically, the encryption itself is per-  with integrated hardware encryption, serious vulnerabilities
             formedbyadedicatedAESco-processor,whereasthesoftware                have also previously been identiﬁed in external drives using
             on the drive (ﬁrmware) takes care of the key management.            proprietary protection schemes. An example is the external
             It is often regarded as the successor of software full-disk         Secustick, which unlocks by simply sending a command (not
             encryption. Full-disk encryption software, especially those         containing a password) [5]. Another example is the Western
             integrated in modern operating systems, may autonomously            Digital MyPassport family of external drives, which suffers
             decide to rely solely on hardware encryption in case it is          from RAM leakage, weak key attacks, or even hardcoded
             supported by the storage device (via the TCG Opal standard).        keys [2]. However these ﬁndings are isolated incidents limited
             In case the decision is made to rely on hardware encryp-            to proprietary solutions, and neither consider implementations
             tion, software encryption is disabled. In fact, BitLocker, the      of established standards for secure storage nor consider these
